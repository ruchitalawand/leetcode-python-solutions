# Power Grid Maintenance

class Solution:
    def makeConnected(self, n, connections):
        # If we don't have enough cables, impossible
        if len(connections) < n - 1:
            return -1
        
        parent = list(range(n))
        size = [1] * n
        
        def find(x):
            while x != parent[x]:
                parent[x] = parent[parent[x]]
                x = parent[x]
            return x
        
        def union(a, b):
            rootA = find(a)
            rootB = find(b)
            
            if rootA != rootB:
                if size[rootA] < size[rootB]:
                    parent[rootA] = rootB
                    size[rootB] += size[rootA]
                else:
                    parent[rootB] = rootA
                    size[rootA] += size[rootB]
        
        for a, b in connections:
            union(a, b)
        
        # Count how many unique connected roots
        roots = {find(i) for i in range(n)}
        
        # To connect k components â†’ need k - 1 extra cables
        return len(roots) - 1
